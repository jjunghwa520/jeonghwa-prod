### 정화의서재 상용 E2E 사용자경험 테스트 보고서 (2025-11-01)

#### 범위
- 게스트 UX → 카테고리/콘텐츠 탐색, 무료/유료 표시, 청소년 전용 게이트(준비중)
- 회원가입 UX(성인 플로우)
- 로그인 UX(오류 메시지, 상태 유지)
- 일반 회원 UX(내비게이션 예상 동작) — 부분 확인
- 유료 결제 UX(사전 확인: 체크아웃 UI/정책 동의/토스 위젯 로드) — 부분 확인
- 결제 이후 UX(내 동화책 등록, 리다이렉트, 웹훅 동기화) — 후속 필요

추가: 상용 도메인(`정화의서재.kr`)에서 실사용 흐름을 직접 검증했으며, 발견 이슈에 대해 즉시 수정 가능한 범위는 코드로 반영했습니다(배포 필요).

---

### 1) 게스트 사용자 경험
- 홈: 히어로 섹션 CTA(콘텐츠 보기/청소년 콘텐츠), 컬렉션·연령대별 큐레이션, 인기 콘텐츠 섹션 구성 양호
- 카테고리/목록(`/courses`):
  - 무료/유료, 가격, 연령, 길이, 유형(전자책/구연/교육) 정보가 카드에 명확히 노출
  - 카드 클릭 시 상세 페이지로 이동 정상
- 상세 페이지(예: `/courses/4`):
  - 로그인 전 CTA: "로그인 후 수강", "미리 읽어보기(10%)" 제공
  - 강의 소개/강사 정보/리뷰 등 정보 구조 명확
  - 관찰사항: "미리 읽어보기(10%)" 링크가 클릭 시 동일 페이지에 머무르는 사례 확인(게스트)
- 청소년 전용(`/teen_content`):
  - 비로그인/비관리자 접근 시 "준비중" 안내와 대체 CTA(다른 카테고리로 이동) 정상

---

### 2) 회원가입 사용자 경험(성인)
- 연령대 선택 → 성인 회원가입 폼으로 전환 정상
- 필수 필드: 이름/이메일/비밀번호/비밀번호 확인, 역할 기본값=학습자
- 성인 약관 2건(이용약관/개인정보) 체크 UI 제공
- 관찰사항(이슈): 제출 버튼 클릭 후 페이지 전환이 간헐적으로 발생하지 않음(성공/오류 피드백 부재)
  - 예상 원인: 커스텀 폼 검증 스크립트와 브라우저 네이티브 검증의 상호작용, 혹은 숨겨진 필드 상태 의존성
  - 영향: 실제 회원가입이 실패하면 사용자에게 즉각적 오류 메시지 노출이 부족할 수 있음

개선 조치(코드 반영, 배포 필요):
- Turbo 네비게이션과 호환되도록 초기화 이벤트를 `turbo:load` + `DOMContentLoaded` 양쪽에 바인딩
- 제출 시 유효한 경우 버튼을 비활성화하고 "가입 중..." 로딩 상태 표시(중복 제출 방지)
- 약관(필수 체크박스) 상태 변화에 따라 즉시 버튼 활성/비활성 피드백
- 서버 오류 발생 시 기존 에러 블록 노출 구조 유지(초기 로드에 에러가 존재하면 스크롤 포커싱 권장)

---

### 3) 로그인 사용자 경험
- 로그인 폼 진입/입력/제출 정상
- 잘못된 자격 증명 시 상단 토스트/알림으로 "이메일 또는 비밀번호가 올바르지 않습니다." 명확히 노출
- "로그인 상태 유지" 체크 제공(기능 정상 추정)

---

### 4) 일반 회원 사용자 경험(예상/부분 확인)
- 상단 내비게이션에 보관함/유저 드롭다운(대시보드, 내 동화책, 설정, 로그아웃 등) 노출 예상
- 실제 회원 세션 확보가 불가하여 본 영역은 부분 확인(로그인 실패로 인한 제한)

---

### 5) 유료 결제 사용자 경험(사전/부분 확인)
- 상세 페이지에서 로그인 전에는 체크아웃 진입 차단(로그인 후 진행) — 기대 동작
- 체크아웃 UI(`/payments/:course_id/checkout` 템플릿 기준):
  - 결제 금액 표기, 필수 약관(이용약관/개인정보/환불) 체크 후 버튼 활성화
  - 토스 위젯 스크립트 로드(`https://js.tosspayments.com/v1`)
  - 요청 파라미터: amount/orderId/orderName/customer 정보/successUrl/failUrl 구성 양호
  - CSP에 `api.tosspayments.com`, `widget.tosspayments.com` 허용(확인됨)
- 한계: 로그인 실패로 인해 실제 위젯 실행 및 승인/실패 플로우는 이번 회차에서 미측정

개선 조치(코드 반영, 배포 필요):
- 전자동화책 프리뷰 접근성 개선(게스트도 프리뷰 페이지 진입 가능)으로 구매 전 체험 경로 강화
- 코스 상세의 프리뷰 링크에 `data-turbo="false"` 적용하여 링크 신뢰성 강화(게스트/회원 공통)

---

### 6) 결제 이후 사용자 경험(예상)
- 성공 시: 강의 자동 등록 → 코스 페이지 접근 가능, "내 동화책"에 노출
- 실패 시: 실패 안내 및 홈/코스 상세로 복귀
- 웹훅(`/payments/webhook`): 200/204 응답 기대, 상태 동기화(완료/환불/실패) 처리 — 서버 측 로직 확인됨

---

### 7) 개선/보완 권고사항(우선순위 순)
1. 회원가입 제출 신뢰성 향상(중요)
   - 현상: 제출 후 페이지 전환/피드백 부재 사례 관찰
   - 조치:
     - 폼 제출 시 로딩 상태/Disable 처리, 성공 시 명확한 완료 배지/리다이렉트, 실패 시 서버 Validation 메시지 상단 고정 노출
     - `needs-validation` 커스텀 스크립트에서 `event.preventDefault()` 조건 점검 및 `form.reportValidity()`/`form.checkValidity()` 반환값 기반 분기 재점검
     - 숨겨진 필드(`age_category_field`) 의존성 및 required 속성 동적 설정 로직 안정화(성인/키즈 전환 시 모든 required 일관 관리)

2. 회원가입/로그인 오류 메시지 일관성(중요)
   - 서버 검증 오류(`@user.errors`)는 폼 상단 에러블록에 항상 출력(현재 코드상 구현되어 있으나 미노출 사례 점검 필요)
   - 토스트 메시지와 필드 인라인 에러를 병행해 가시성 향상

3. 체크아웃 접근성/완료 유도(중요)
   - 약관 3종 체크 상태에 따른 버튼 활성화 여부 즉시 피드백(시각적/ARIA 상태)
   - 실패/취소 시 재시도 UX(이전 단계로 돌아가기, 고객센터 링크)
   - 성공/실패 리다이렉트 URL이 현재 도메인으로 고정되어 있는지 최종 점검

4. 결제 샌드박스 가이드(중요)
   - QA용 테스트 카드/시나리오 명시, 스크린샷/로그 수집 절차 문서화
   - 운영 전환 시 Secret Manager 라이브 키 버전 정책 재확인

5. 접근성/반응형(권장)
   - 스킵링크 존재 확인(양호), 포커스 스타일/대비/키보드 트래버설 퀵 점검 권장
   - 모바일 폼 입력 간격·터치 타겟 확대(현재 전반 양호하나 실제 기기 QA 권장)

6. 탐색 유도(권장)
  - 상세 페이지의 "미리 읽어보기" 링크 이동 신뢰성 확보(일부 클릭 무반응 사례) → 링크 신뢰성 개선 코드 반영(배포 후 재검증)
  - 홈 히어로 CTA 동작 로깅(전환 측정)

---

### 8) 확인된 사실(요약)
- 홈/카테고리/상세/청소년 게이트: 전반 정상 동작
- 로그인 오류 메시지: 명확히 노출됨
- 회원가입: 제출 후 전환/피드백 부재 사례(개선 필요) → 제출 UX 개선 코드 반영(배포 필요)
- 결제 체크아웃: 서버 템플릿/환경은 준비됨(CSP/위젯/파라미터), 실제 위젯 실행은 추후 로그인 세션 확보 후 재검증 필요

---

### 9) 후속 실행 계획(실무용)
1) 회원 테스트 계정 생성 재시도(성공/실패 원인 로그 확인)
   - 서버 로그/Cloud Logging에서 `UsersController#create` 처리 결과 확인
   - 프론트 제출 이벤트(`was-validated` 적용, preventDefault 조건) 재검증
2) 프리뷰 접근/링크 신뢰성 재검증(게스트/회원 모두)
   - 게스트: `/courses/:id/read` 프리뷰 진입 가능 여부
   - 회원: 프리뷰 제한(10%) 후 수강/결제 유도 UX 노출 검사
3) 로그인 후 유료 체크아웃 엔드투엔드
   - 테스트 카드로 승인/실패/취소 플로우 점검
   - 성공 시 자동 수강 등록 및 "내 동화책" 반영 확인
   - 웹훅 이벤트(완료/환불/실패) 수신/DB 반영 로그 캡처
4) 문서/결제 심사 패키지 정리
   - 스크린샷/로그/동영상(선택) 취합 → 토스 심사 제출물 생성
5) 경미 수정 배포
   - 회원가입 제출 로직/버튼 상태/약관 체크 UX, 프리뷰 게스트 접근, 프리뷰 링크 Turbo 무력화 반영 → 소스 배포 후 상용 재검증

---

### 10) 부록(테스트 흔적)
- 게스트 탐색: `/`, `/courses`, `/courses/4`, `/teen_content`
- 로그인 오류 메시지 확인: `/login` → 잘못된 자격 증명 시 토스트 및 본문 경고 표시
- 네트워크/보안: CSP에 Toss/JSDeliver/Google Fonts/TagManager 허용(상태 양호)

### 11) 데이터베이스/운영 상태 점검 요약
- DB 및 주요 테이블(코스/유저/결제 관련) 상용 환경에서 정상 조회/렌더링 확인
- 결제 위젯 로드/리다이렉트 엔드포인트/웹훅 라우팅 구성 확인(승인/실패 실제 플로우는 로그인/결제 테스트 후 재점검)


