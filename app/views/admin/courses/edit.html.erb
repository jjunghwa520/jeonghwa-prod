<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1>üìù ÏΩîÏä§ ÏàòÏ†ï</h1>
      <h4 class="text-muted"><%= @course.title %></h4>
    </div>
    <div class="d-flex gap-2">
      <%= link_to "‚Üê Î™©Î°ù", admin_courses_path, class: "btn btn-outline-secondary" %>
      <%= link_to "üëÅÔ∏è ÎØ∏Î¶¨Î≥¥Í∏∞", course_path(@course), class: "btn btn-info", target: "_blank" %>
      <%= link_to "üìÅ ÏÉÅÏÑ∏Î≥¥Í∏∞", admin_course_path(@course), class: "btn btn-outline-primary" %>
    </div>
  </div>

  <!-- ÏΩòÌÖêÏ∏† ÌòÑÌô© -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h6 class="mb-0">üìä ÏΩòÌÖêÏ∏† ÌòÑÌô©</h6>
        </div>
        <div class="card-body">
          <% if @course.category.to_s.match?(/Ï†ÑÏûêÎèôÌôîÏ±Ö|ebook|ÎèôÌôîÏ±Ö/) %>
            <p class="mb-2">
              <strong>ÌéòÏù¥ÏßÄ Ïù¥ÎØ∏ÏßÄ:</strong> 
              <span class="badge bg-<%= @content_status[:page_count] >= 10 ? 'success' : 'warning' %>">
                <%= @content_status[:page_count] %>Í∞ú
              </span>
            </p>
            <p class="mb-0">
              <strong>Ï∫°ÏÖò:</strong>
              <span class="badge bg-<%= @content_status[:caption_count] >= 10 ? 'success' : 'secondary' %>">
                <%= @content_status[:caption_count] %>Í∞ú
              </span>
            </p>
          <% else %>
            <p class="mb-0">
              <strong>ÎπÑÎîîÏò§:</strong>
              <span class="badge bg-<%= @content_status[:has_video] ? 'success' : 'danger' %>">
                <%= @content_status[:has_video] ? 'ÏûàÏùå' : 'ÏóÜÏùå' %>
              </span>
            </p>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header bg-info text-white">
          <h6 class="mb-0">‚ÑπÔ∏è ÏΩîÏä§ Ï†ïÎ≥¥</h6>
        </div>
        <div class="card-body">
          <p class="mb-1"><strong>ID:</strong> <%= @course.id %></p>
          <p class="mb-1"><strong>Ïπ¥ÌÖåÍ≥†Î¶¨:</strong> <%= @course.category %></p>
          <p class="mb-1"><strong>ÏÉÅÌÉú:</strong> <%= @course.status %></p>
          <p class="mb-0"><strong>Îì±Î°ùÏùº:</strong> <%= @course.created_at.strftime('%Y-%m-%d') %></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
  <ul class="nav nav-tabs mb-4" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" data-bs-toggle="tab" href="#basic-info">Í∏∞Î≥∏ Ï†ïÎ≥¥</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" data-bs-toggle="tab" href="#files">ÌååÏùº Í¥ÄÎ¶¨</a>
    </li>
  </ul>

  <div class="tab-content">
    <!-- Í∏∞Î≥∏ Ï†ïÎ≥¥ ÌÉ≠ -->
    <div class="tab-pane fade show active" id="basic-info">
      <%= form_with model: [:admin, @course], html: { class: 'needs-validation' } do |f| %>
        <div class="row g-3">
          <!-- Ï†úÎ™© & Î∂ÄÏ†úÎ™© -->
          <div class="col-md-8">
            <%= f.label :title, 'Ï†úÎ™© *', class: 'form-label' %>
            <%= f.text_field :title, class: 'form-control', required: true %>
          </div>
          <div class="col-md-4">
            <%= f.label :subtitle, 'Î∂ÄÏ†úÎ™©', class: 'form-label' %>
            <%= f.text_field :subtitle, class: 'form-control' %>
          </div>

          <!-- ÏãúÎ¶¨Ï¶à -->
          <div class="col-md-8">
            <%= f.label :series_name, 'ÏãúÎ¶¨Ï¶à', class: 'form-label' %>
            <%= f.text_field :series_name, class: 'form-control', list: 'series-list' %>
            <datalist id="series-list">
              <% Course.distinct.pluck(:series_name).compact.each do |series| %>
                <option value="<%= series %>">
              <% end %>
            </datalist>
          </div>
          <div class="col-md-4">
            <%= f.label :series_order, 'ÏàúÏÑú', class: 'form-label' %>
            <%= f.number_field :series_order, class: 'form-control', min: 1 %>
          </div>

          <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ & Ïó∞Î†π -->
          <div class="col-md-4">
            <%= f.label :category, 'Ïπ¥ÌÖåÍ≥†Î¶¨ *', class: 'form-label' %>
            <%= f.select :category,
              options_for_select([
                ['Ï†ÑÎûòÎèôÌôî', 'Ï†ÑÎûòÎèôÌôî'],
                ['Î™ÖÏûëÎèôÌôî', 'Î™ÖÏûëÎèôÌôî'],
                ['Ï∞ΩÏûëÎèôÌôî', 'Ï∞ΩÏûëÎèôÌôî'],
                ['Ï†ÑÏûêÎèôÌôîÏ±Ö', 'Ï†ÑÏûêÎèôÌôîÏ±Ö'],
                ['Íµ¨Ïó∞ÎèôÌôî', 'Íµ¨Ïó∞ÎèôÌôî'],
                ['ÍµêÏú°ÏûêÎ£å', 'ÍµêÏú°ÏûêÎ£å']
              ], @course.category),
              {},
              class: 'form-select',
              required: true
            %>
          </div>
          <div class="col-md-4">
            <%= f.label :age, 'Ïó∞Î†π *', class: 'form-label' %>
            <%= f.select :age,
              options_for_select([
                ['ÏïÑÍ∏∞ (0-2ÏÑ∏)', 'baby'],
                ['Ïú†ÏïÑ (3-5ÏÑ∏)', 'toddler'],
                ['Ï¥àÎì± (6-13ÏÑ∏)', 'elementary'],
                ['Ï≤≠ÏÜåÎÖÑ (14-16ÏÑ∏)', 'teen']
              ], @course.age),
              {},
              class: 'form-select',
              required: true
            %>
          </div>
          <div class="col-md-4">
            <%= f.label :difficulty, 'ÎÇúÏù¥ÎèÑ', class: 'form-label' %>
            <div class="difficulty-selector">
              <% (1..5).each do |level| %>
                <%= f.radio_button :difficulty, level, id: "difficulty_#{level}", checked: (@course.difficulty == level) %>
                <label for="difficulty_<%= level %>">‚≠ê</label>
              <% end %>
            </div>
          </div>

          <!-- Í∞ÄÍ≤© & Ìï†Ïù∏ -->
          <div class="col-md-4">
            <%= f.label :price, 'Í∞ÄÍ≤© (Ïõê) *', class: 'form-label' %>
            <%= f.number_field :price, class: 'form-control', step: '100', required: true %>
          </div>
          <div class="col-md-4">
            <%= f.label :discount_percentage, 'Ìï†Ïù∏Ïú® (%)', class: 'form-label' %>
            <%= f.number_field :discount_percentage, class: 'form-control', min: 0, max: 100 %>
          </div>
          <div class="col-md-4">
            <%= f.label :level, 'Î†àÎ≤® *', class: 'form-label' %>
            <%= f.select :level,
              options_for_select([
                ['Ï¥àÍ∏â', 'beginner'],
                ['Ï§ëÍ∏â', 'intermediate'],
                ['Í≥†Í∏â', 'advanced']
              ], @course.level),
              {},
              class: 'form-select',
              required: true
            %>
          </div>

          <!-- ÏÜåÏöîÏãúÍ∞Ñ & Ï†úÏûëÏùº -->
          <div class="col-md-6">
            <%= f.label :duration, 'ÏÜåÏöîÏãúÍ∞Ñ (Î∂Ñ) *', class: 'form-label' %>
            <%= f.number_field :duration, class: 'form-control', required: true %>
          </div>
          <div class="col-md-6">
            <%= f.label :production_date, 'Ï†úÏûëÏùº', class: 'form-label' %>
            <%= f.date_field :production_date, class: 'form-control' %>
          </div>

          <!-- ÌÉúÍ∑∏ -->
          <div class="col-12">
            <%= f.label :tags, 'ÌÉúÍ∑∏', class: 'form-label' %>
            <%= f.text_field :tags, class: 'form-control', placeholder: '#ÎèôÎ¨º, #Ïö∞Ï†ï, #ÍµêÌõà' %>
            <small class="form-text text-muted">ÏâºÌëúÎ°ú Íµ¨Î∂Ñ</small>
          </div>

          <!-- ÏÑ§Î™Ö -->
          <div class="col-12">
            <%= f.label :description, 'ÏÑ§Î™Ö *', class: 'form-label' %>
            <%= f.text_area :description, rows: 5, class: 'form-control', required: true %>
          </div>

          <!-- Ï†úÏûëÏßÑ -->
          <div class="col-12">
            <h5 class="mt-3">üë• Ï†úÏûëÏßÑ</h5>
          </div>
          <div class="col-md-4">
            <label class="form-label">ÏûëÍ∞Ä</label>
            <%= select_tag 'course[writer_id]',
              options_from_collection_for_select(@authors.writers, :id, :name, @course.writer&.id),
              { include_blank: 'ÏÑ†ÌÉùÌïòÏÑ∏Ïöî', class: 'form-select' }
            %>
          </div>
          <div class="col-md-4">
            <label class="form-label">ÏùºÎü¨Ïä§Ìä∏Î†àÏù¥ÌÑ∞</label>
            <%= select_tag 'course[illustrator_id]',
              options_from_collection_for_select(@authors.illustrators, :id, :name, @course.illustrator&.id),
              { include_blank: 'ÏÑ†ÌÉùÌïòÏÑ∏Ïöî', class: 'form-select' }
            %>
          </div>
          <div class="col-md-4">
            <label class="form-label">ÏÑ±Ïö∞</label>
            <%= select_tag 'course[narrator_id]',
              options_from_collection_for_select(@authors.narrators, :id, :name, @course.narrator&.id),
              { include_blank: 'ÏÑ†ÌÉùÌïòÏÑ∏Ïöî', class: 'form-select' }
            %>
          </div>

          <!-- Ïç∏ÎÑ§Ïùº & ÏÉÅÌÉú -->
          <div class="col-md-8">
            <%= f.label :thumbnail, 'Ïç∏ÎÑ§Ïùº URL', class: 'form-label' %>
            <%= f.url_field :thumbnail, class: 'form-control' %>
          </div>
          <div class="col-md-4">
            <%= f.label :status, 'ÏÉÅÌÉú', class: 'form-label' %>
            <%= f.select :status,
              options_for_select([
                ['Î∞úÌñâÎê®', 'published'],
                ['ÏûÑÏãúÏ†ÄÏû•', 'draft'],
                ['Î≥¥Í¥ÄÎê®', 'archived']
              ], @course.status),
              {},
              class: 'form-select'
            %>
          </div>

          <!-- Ï†úÏ∂ú -->
          <div class="col-12 mt-4">
            <%= f.submit "üíæ Ï†ÄÏû•", class: "btn btn-primary btn-lg" %>
            <%= link_to "Ï∑®ÏÜå", admin_course_path(@course), class: "btn btn-outline-secondary btn-lg" %>
          </div>
        </div>
      <% end %>
    </div>

    <!-- ÌååÏùº Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div class="tab-pane fade" id="files">
      <div class="row">
        <!-- Í∏∞Ï°¥ ÌååÏùº Î™©Î°ù -->
        <div class="col-md-6">
          <div class="card mb-4">
            <div class="card-header bg-success text-white">
              <h6 class="mb-0">üìÅ Í∏∞Ï°¥ ÌååÏùº</h6>
            </div>
            <div class="card-body">
              <% if @course.category.to_s.match?(/Ï†ÑÏûêÎèôÌôîÏ±Ö|ebook|ÎèôÌôîÏ±Ö/) %>
                <!-- Ïù¥ÎØ∏ÏßÄ ÌååÏùº -->
                <h6 class="mt-2">ÌéòÏù¥ÏßÄ Ïù¥ÎØ∏ÏßÄ (<%= @existing_files[:images].count %>Í∞ú)</h6>
                <div class="list-group mb-3">
                  <% @existing_files[:images].each do |file| %>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                      <div>
                        <i class="bi bi-file-image"></i>
                        <%= file[:name] %>
                        <small class="text-muted">(<%= number_to_human_size(file[:size]) %>)</small>
                      </div>
                      <button class="btn btn-sm btn-outline-danger" onclick="deleteFile('<%= file[:path] %>')">
                        üóëÔ∏è
                      </button>
                    </div>
                  <% end %>
                </div>

                <!-- Ï∫°ÏÖò ÌååÏùº -->
                <h6 class="mt-3">Ï∫°ÏÖò (<%= @existing_files[:captions].count %>Í∞ú)</h6>
                <div class="list-group">
                  <% @existing_files[:captions].each do |file| %>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                      <div>
                        <i class="bi bi-file-text"></i>
                        <%= file[:name] %>
                        <small class="text-muted">(<%= number_to_human_size(file[:size]) %>)</small>
                      </div>
                      <button class="btn btn-sm btn-outline-danger" onclick="deleteFile('<%= file[:path] %>')">
                        üóëÔ∏è
                      </button>
                    </div>
                  <% end %>
                </div>
              <% else %>
                <!-- ÎπÑÎîîÏò§ ÌååÏùº -->
                <h6>ÎπÑÎîîÏò§ ÌååÏùº (<%= @existing_files[:videos].count %>Í∞ú)</h6>
                <div class="list-group mb-3">
                  <% @existing_files[:videos].each do |file| %>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                      <div>
                        <i class="bi bi-file-play"></i>
                        <%= file[:name] %>
                        <small class="text-muted">(<%= number_to_human_size(file[:size]) %>)</small>
                      </div>
                      <button class="btn btn-sm btn-outline-danger" onclick="deleteFile('<%= file[:path] %>')">
                        üóëÔ∏è
                      </button>
                    </div>
                  <% end %>
                </div>

                <!-- ÏûêÎßâ ÌååÏùº -->
                <h6 class="mt-3">ÏûêÎßâ (<%= @existing_files[:subtitles].count %>Í∞ú)</h6>
                <div class="list-group">
                  <% @existing_files[:subtitles].each do |file| %>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                      <div>
                        <i class="bi bi-file-earmark-text"></i>
                        <%= file[:name] %>
                        <small class="text-muted">(<%= number_to_human_size(file[:size]) %>)</small>
                      </div>
                      <button class="btn btn-sm btn-outline-danger" onclick="deleteFile('<%= file[:path] %>')">
                        üóëÔ∏è
                      </button>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>

        <!-- ÌååÏùº Ï∂îÍ∞Ä -->
        <div class="col-md-6">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <h6 class="mb-0">‚ûï ÌååÏùº Ï∂îÍ∞Ä</h6>
            </div>
            <div class="card-body">
              <form id="file-upload-form" enctype="multipart/form-data">
                <div class="mb-3">
                  <label class="form-label">ÌååÏùº Ï¢ÖÎ•ò</label>
                  <select id="content-type-select" class="form-select">
                    <% if @course.category.to_s.match?(/Ï†ÑÏûêÎèôÌôîÏ±Ö|ebook|ÎèôÌôîÏ±Ö/) %>
                      <option value="ebook_images">ÌéòÏù¥ÏßÄ Ïù¥ÎØ∏ÏßÄ (.jpg, .png)</option>
                      <option value="captions">Ï∫°ÏÖò (.txt)</option>
                    <% else %>
                      <option value="video">ÎπÑÎîîÏò§ (.mp4, .webm)</option>
                      <option value="subtitle">ÏûêÎßâ (.vtt, .srt)</option>
                      <option value="hls">HLS (.ts, .m3u8)</option>
                    <% end %>
                  </select>
                </div>

                <div class="file-upload-dropzone" id="edit-file-dropzone">
                  <div class="text-center">
                    <i class="bi bi-cloud-upload display-4 text-muted"></i>
                    <p class="mt-3">ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉù</p>
                    <input type="file" id="edit-file-input" multiple style="display: none;">
                    <button type="button" class="btn btn-primary" onclick="document.getElementById('edit-file-input').click()">
                      ÌååÏùº ÏÑ†ÌÉù
                    </button>
                  </div>
                  <div id="edit-file-list" class="mt-3" style="display: none;"></div>
                </div>

                <button type="button" id="upload-files-btn" class="btn btn-success w-100 mt-3" disabled>
                  üì§ ÏóÖÎ°úÎìú
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ÌååÏùº ÏÇ≠Ï†ú
async function deleteFile(path) {
  if (!confirm('Ïù¥ ÌååÏùºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;

  try {
    const response = await fetch(`/admin/courses/<%= @course.id %>/delete_file`, {
      method: 'DELETE',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
      },
      body: JSON.stringify({ file_path: path })
    });

    if (response.ok) {
      alert('ÌååÏùºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
      location.reload();
    } else {
      alert('ÌååÏùº ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§');
    }
  } catch (error) {
    console.error('Error:', error);
    alert('Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§');
  }
}

// ÌååÏùº ÏóÖÎ°úÎìú (ÏàòÏ†ï ÌéòÏù¥ÏßÄÏö©)
document.addEventListener('DOMContentLoaded', function() {
  const dropzone = document.getElementById('edit-file-dropzone');
  const fileInput = document.getElementById('edit-file-input');
  const fileList = document.getElementById('edit-file-list');
  const uploadBtn = document.getElementById('upload-files-btn');
  const contentTypeSelect = document.getElementById('content-type-select');
  let selectedFiles = [];

  if (!dropzone) return;

  dropzone.addEventListener('click', function(e) {
    if (e.target.tagName !== 'BUTTON') {
      fileInput.click();
    }
  });

  dropzone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropzone.classList.add('dragover');
  });

  dropzone.addEventListener('dragleave', () => {
    dropzone.classList.remove('dragover');
  });

  dropzone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropzone.classList.remove('dragover');
    selectedFiles = Array.from(e.dataTransfer.files);
    displayFiles();
  });

  fileInput.addEventListener('change', (e) => {
    selectedFiles = Array.from(e.target.files);
    displayFiles();
  });

  function displayFiles() {
    if (selectedFiles.length === 0) {
      fileList.style.display = 'none';
      uploadBtn.disabled = true;
      return;
    }

    fileList.style.display = 'block';
    fileList.innerHTML = '<h6>ÏÑ†ÌÉùÎêú ÌååÏùº:</h6>';
    
    const listGroup = document.createElement('div');
    listGroup.className = 'list-group';
    
    selectedFiles.forEach(file => {
      const item = document.createElement('div');
      item.className = 'list-group-item';
      item.textContent = `${file.name} (${(file.size / 1024).toFixed(1)} KB)`;
      listGroup.appendChild(item);
    });
    
    fileList.appendChild(listGroup);
    uploadBtn.disabled = false;
  }

  uploadBtn.addEventListener('click', async function() {
    const formData = new FormData();
    formData.append('content_type', contentTypeSelect.value);
    selectedFiles.forEach(file => {
      formData.append('files[]', file);
    });

    uploadBtn.disabled = true;
    uploadBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>ÏóÖÎ°úÎìú Ï§ë...';
    
    // ÏßÑÌñâÎ•† ÌëúÏãú
    const progressDiv = document.createElement('div');
    progressDiv.className = 'mt-3';
    progressDiv.innerHTML = `
      <div class="progress">
        <div id="upload-progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%">0%</div>
      </div>
    `;
    uploadBtn.parentElement.insertBefore(progressDiv, uploadBtn.nextSibling);
    const progressBar = progressDiv.querySelector('#upload-progress');

    try {
      const xhr = new XMLHttpRequest();
      
      // ÏßÑÌñâÎ•† Î™®ÎãàÌÑ∞ÎßÅ
      xhr.upload.addEventListener('progress', (e) => {
        if (e.lengthComputable) {
          const percentComplete = (e.loaded / e.total) * 100;
          progressBar.style.width = percentComplete + '%';
          progressBar.textContent = Math.round(percentComplete) + '%';
        }
      });
      
      xhr.addEventListener('load', function() {
        if (xhr.status === 200) {
          showToast('ÌååÏùºÏù¥ ÏóÖÎ°úÎìúÎêòÏóàÏäµÎãàÎã§', 'success');
          setTimeout(() => location.reload(), 1000);
        } else {
          const data = JSON.parse(xhr.responseText);
          showToast('ÏóÖÎ°úÎìú Ïã§Ìå®: ' + (data.errors || ['Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò']).join(', '), 'error');
        }
      });
      
      xhr.addEventListener('error', function() {
        showToast('ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
      });
      
      xhr.open('POST', '/admin/courses/<%= @course.id %>/upload_files');
      xhr.setRequestHeader('X-CSRF-Token', document.querySelector('meta[name="csrf-token"]').content);
      xhr.send(formData);
      
    } catch (error) {
      console.error('Error:', error);
      showToast('Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
    } finally {
      setTimeout(() => {
        uploadBtn.disabled = false;
        uploadBtn.textContent = 'üì§ ÏóÖÎ°úÎìú';
        if (progressDiv) progressDiv.remove();
      }, 2000);
    }
  });
  
  // Toast ÏïåÎ¶º ÏãúÏä§ÌÖú
  window.showToast = function(message, type = 'info') {
    const toastContainer = document.getElementById('toast-container') || createToastContainer();
    
    const toast = document.createElement('div');
    toast.className = `toast align-items-center text-white bg-${type === 'success' ? 'success' : type === 'error' ? 'danger' : type === 'warning' ? 'warning' : 'info'} border-0`;
    toast.setAttribute('role', 'alert');
    toast.innerHTML = `
      <div class="d-flex">
        <div class="toast-body">${message}</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
      </div>
    `;
    
    toastContainer.appendChild(toast);
    const bsToast = new bootstrap.Toast(toast);
    bsToast.show();
    
    setTimeout(() => toast.remove(), 5000);
  };

  function createToastContainer() {
    const container = document.createElement('div');
    container.id = 'toast-container';
    container.className = 'toast-container position-fixed top-0 end-0 p-3';
    container.style.zIndex = '9999';
    document.body.appendChild(container);
    return container;
  }
});
</script>

<style>
.difficulty-selector {
  display: flex;
  gap: 0.5rem;
}

.difficulty-selector input[type="radio"] {
  display: none;
}

.difficulty-selector label {
  font-size: 1.5rem;
  cursor: pointer;
  opacity: 0.3;
}

.difficulty-selector input:checked ~ label,
.difficulty-selector input:checked + label {
  opacity: 1;
}

.file-upload-dropzone {
  border: 2px dashed #dee2e6;
  border-radius: 0.5rem;
  padding: 2rem;
  cursor: pointer;
  transition: all 0.3s;
}

.file-upload-dropzone.dragover {
  border-color: #0d6efd;
  background-color: #e7f1ff;
}

/* Î™®Î∞îÏùº Î∞òÏùëÌòï */
@media (max-width: 768px) {
  .card-body {
    padding: 1rem;
  }
  
  .difficulty-selector label {
    font-size: 1.2rem;
  }
  
  .form-control, .form-select {
    font-size: 16px !important;
  }
}
</style>

<script>
// Îç∞Ïù¥ÌÑ∞ ÏÜêÏã§ Î∞©ÏßÄ
let isDirty = false;
let isSubmitting = false;

document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('input, textarea, select').forEach(el => {
    el.addEventListener('change', () => isDirty = true);
  });
  
  window.addEventListener('beforeunload', (e) => {
    if (isDirty && !isSubmitting) {
      e.preventDefault();
      e.returnValue = 'ÏàòÏ†ï Ï§ëÏù∏ ÎÇ¥Ïö©Ïù¥ Ï†ÄÏû•ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§. Ï†ïÎßê ÎÇòÍ∞ÄÏãúÍ≤†ÏäµÎãàÍπå?';
    }
  });
  
  // Ìèº Ï†úÏ∂ú Ïãú
  const form = document.querySelector('form');
  if (form) {
    form.addEventListener('submit', function() {
      isSubmitting = true;
      isDirty = false;
    });
  }
});
</script>
