<div class="container mx-auto px-4 py-8 max-w-5xl">
  <!-- 페이지 헤더 -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">주문 내역</h1>
    <p class="text-gray-600"><%= @user.name %>님의 결제 내역입니다.</p>
  </div>

  <!-- 상태 필터 -->
  <div class="mb-6 flex gap-2 flex-wrap">
    <%= link_to user_orders_path(@user), 
        class: "px-4 py-2 rounded-lg #{params[:status].blank? ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'}" do %>
      전체
    <% end %>
    
    <%= link_to user_orders_path(@user, status: 'completed'), 
        class: "px-4 py-2 rounded-lg #{params[:status] == 'completed' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'}" do %>
      결제 완료
    <% end %>
    
    <%= link_to user_orders_path(@user, status: 'refunded'), 
        class: "px-4 py-2 rounded-lg #{params[:status] == 'refunded' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'}" do %>
      환불 완료
    <% end %>
    
    <%= link_to user_orders_path(@user, status: 'pending'), 
        class: "px-4 py-2 rounded-lg #{params[:status] == 'pending' ? 'bg-blue-500 text-white' : 'bg-gray-100 text-gray-700'}" do %>
      대기 중
    <% end %>
  </div>

  <!-- 주문 목록 -->
  <% if @orders.any? %>
    <div class="space-y-4">
      <% @orders.each do |order| %>
        <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <div class="flex items-center justify-between mb-4">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-2">
                <h3 class="text-lg font-semibold text-gray-800">
                  <%= link_to order.course.title, course_path(order.course), class: "hover:text-blue-600" %>
                </h3>
                <span class="px-3 py-1 rounded-full text-sm font-medium <%= order_status_class(order.status) %>">
                  <%= order_status_text(order.status) %>
                </span>
              </div>
              
              <div class="text-sm text-gray-600 space-y-1">
                <p>주문번호: <span class="font-mono text-gray-800"><%= order.order_id %></span></p>
                <p>주문일시: <%= order.created_at.strftime('%Y년 %m월 %d일 %H:%M') %></p>
                <% if order.status == 'refunded' && order.refunded_at %>
                  <p>환불일시: <%= order.refunded_at.strftime('%Y년 %m월 %d일 %H:%M') %></p>
                <% end %>
              </div>
            </div>
            
            <div class="text-right ml-4">
              <p class="text-2xl font-bold text-gray-800 mb-3">
                <%= number_to_currency(order.amount, unit: '₩', format: '%n%u', precision: 0) %>
              </p>
              <%= link_to user_order_path(@user, order), class: "inline-block px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" do %>
                상세보기
              <% end %>
            </div>
          </div>
          
          <!-- 환불 가능 표시 -->
          <% if order.refundable? %>
            <div class="mt-3 pt-3 border-t border-gray-200">
              <p class="text-sm text-green-600">💡 7일 이내 환불 가능</p>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
    
    <!-- 페이지네이션 -->
    <div class="mt-8">
      <%= paginate @orders %>
    </div>
  <% else %>
    <div class="bg-gray-50 rounded-lg p-12 text-center">
      <div class="text-6xl mb-4">📦</div>
      <h3 class="text-xl font-semibold text-gray-700 mb-2">주문 내역이 없습니다</h3>
      <p class="text-gray-600 mb-6">아직 구매한 강의가 없어요. 다양한 전자동화책을 만나보세요!</p>
      <%= link_to "강의 둘러보기", root_path, class: "inline-block px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors" %>
    </div>
  <% end %>
</div>

<%# 헬퍼 메소드가 필요하므로 application_helper.rb에 추가해야 함 %>

