<!DOCTYPE html>
<html lang="ko">
  <head>
    <title><%= content_for?(:title) ? yield(:title) : "ì •í™”ì˜ ì„œì¬ - ë™í™”ì±… ì„¸ìƒì˜ ë§ˆë²•" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta charset="UTF-8">
    <meta name="description" content="ì•„ì´ë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ë™í™”ì±… í”Œë«í¼">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ°</text></svg>">
    
    <!-- Fonts -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- AOS Animation (removed) -->
    
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>
  </head>

  <body>
    <a href="#main" class="skip-link">ë³¸ë¬¸ ë°”ë¡œê°€ê¸°</a>
    <!-- ëª¨ë˜ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar navbar-expand-lg nav-premium" id="mainNav">
      <div class="container">
        <!-- ë¸Œëœë“œ ë¡œê³  -->
        <%= link_to root_path, class: "navbar-brand" do %>
          <div class="brand-wrapper">
            <div class="brand-info">
              <h1 class="brand-name" style="background:none;-webkit-text-fill-color:initial;">ì •í™”ì˜ ì„œì¬</h1>
              <p class="brand-tagline">ë™í™”ì±… í”Œë«í¼</p>
            </div>
          </div>
        <% end %>
        
        <!-- ëª¨ë°”ì¼ í† ê¸€ ë²„íŠ¼ -->
        <button class="navbar-toggler custom-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
          <span class="toggler-icon"></span>
          <span class="toggler-icon"></span>
          <span class="toggler-icon"></span>
        </button>
        
        <!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item"><%= link_to "í™ˆ", root_path, class: "nav-premium-link #{current_page?(root_path) ? 'active' : ''}" %></li>
            <li class="nav-item"><%= link_to "ì „ìë™í™”ì±…", courses_path(category: 'ebook'), class: "nav-premium-link #{params[:category] == 'ebook' ? 'active' : ''}" %></li>
            <li class="nav-item"><%= link_to "êµ¬ì—°ë™í™”", courses_path(category: 'storytelling'), class: "nav-premium-link #{params[:category] == 'storytelling' ? 'active' : ''}" %></li>
            <li class="nav-item"><%= link_to "ë™í™”ë§Œë“¤ê¸°", courses_path(category: 'education'), class: "nav-premium-link #{params[:category] == 'education' ? 'active' : ''}" %></li>
            <li class="nav-item"><%= link_to "ì²­ì†Œë…„ ì½˜í…ì¸ ", teen_content_path, class: "nav-premium-link #{current_page?(teen_content_path) ? 'active' : ''}" %></li>
          </ul>
          
          <!-- ìš°ì¸¡ ë©”ë‰´ -->
          <ul class="navbar-nav">
            <% if logged_in? %>
              <!-- ì¥ë°”êµ¬ë‹ˆ -->
              <li class="nav-item"><%= link_to "ë³´ê´€í•¨", cart_items_path, class: "nav-premium-link position-relative" %></li>
              
              <!-- ì‚¬ìš©ì ë“œë¡­ë‹¤ìš´ -->
              <li class="nav-item dropdown">
                <a class="nav-premium-link dropdown-toggle user-menu" href="#" data-bs-toggle="dropdown">
                  <span class="user-avatar">
                    <%= current_user.name.first.upcase %>
                  </span>
                  <span class="d-none d-lg-inline"><%= current_user.name %></span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li class="dropdown-header">
                    <div class="user-info">
                      <strong><%= current_user.name %></strong>
                      <small class="text-muted"><%= current_user.email %></small>
                    </div>
                  </li>
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <%= link_to dashboard_user_path(current_user), class: "dropdown-item" do %>
                      <i class="bi bi-speedometer2 me-2"></i>ëŒ€ì‹œë³´ë“œ
                    <% end %>
                  </li>
                  <li>
                    <%= link_to my_courses_user_path(current_user), class: "dropdown-item" do %>
                      <i class="bi bi-book me-2"></i>ë‚´ ë™í™”ì±…
                    <% end %>
                  </li>
                  <% if current_user.instructor? %>
                    <li>
                      <%= link_to my_teachings_user_path(current_user), class: "dropdown-item" do %>
                        <i class="bi bi-mortarboard me-2"></i>ì‘ê°€ ë©”ë‰´
                      <% end %>
                    </li>
                    <li>
                      <%= link_to new_course_path, class: "dropdown-item" do %>
                        <i class="bi bi-plus-circle me-2"></i>ìƒˆ ë™í™” ë“±ë¡
                      <% end %>
                    </li>
                  <% end %>
                  <li>
                    <%= link_to edit_user_path(current_user), class: "dropdown-item" do %>
                      <i class="bi bi-gear me-2"></i>ì„¤ì •
                    <% end %>
                  </li>
                  <li><hr class="dropdown-divider"></li>
                  <li>
                    <%= button_to logout_path, method: :delete, class: "dropdown-item text-danger" do %>
                      <i class="bi bi-box-arrow-right me-2"></i>ë¡œê·¸ì•„ì›ƒ
                    <% end %>
                  </li>
                </ul>
              </li>
            <% else %>
              <li class="nav-item"><%= link_to "ë¡œê·¸ì¸", login_path, class: "btn-minimal btn-minimal-secondary me-2" %></li>
              <li class="nav-item"><%= link_to "íšŒì›ê°€ì…", signup_path, class: "btn-minimal btn-minimal-primary" %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </nav>

    <!-- í”Œë˜ì‹œ ë©”ì‹œì§€ -->
    <% if flash.any? %>
      <div class="toast-container">
        <% flash.each do |type, message| %>
          <div class="toast-modern <%= type == 'notice' ? 'success' : 'warning' %> show">
            <div class="toast-header">
              <strong class="me-auto">
                <%= type == 'notice' ? 'âœ… ì„±ê³µ' : 'âš ï¸ ì•Œë¦¼' %>
              </strong>
              <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body">
              <%= message %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main id="main" class="main-content">
      <%= yield %>
    </main>

    <!-- ëª¨ë˜ í‘¸í„° -->
    <footer class="footer-modern">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 mb-4">
            <div class="footer-brand">
              <h3 class="gradient-text mb-3">ğŸ° ì •í™”ì˜ ì„œì¬</h3>
              <p class="text-muted">
                ì•„ì´ë“¤ì˜ ìƒìƒë ¥ì„ í‚¤ìš°ëŠ”<br>
                íŠ¹ë³„í•œ ë™í™”ì±… í”Œë«í¼
              </p>
              <div class="social-links mt-3">
                <a href="#" class="social-link"><i class="bi bi-facebook"></i></a>
                <a href="#" class="social-link"><i class="bi bi-instagram"></i></a>
                <a href="#" class="social-link"><i class="bi bi-youtube"></i></a>
                <a href="#" class="social-link"><i class="bi bi-twitter"></i></a>
              </div>
            </div>
          </div>
          
          <div class="col-lg-2 col-md-4 mb-4">
            <h5 class="footer-title">ì„œë¹„ìŠ¤</h5>
            <ul class="footer-links">
              <li><%= link_to "ì „ìë™í™”ì±…", courses_path(category: 'ebook') %></li>
              <li><%= link_to "êµ¬ì—°ë™í™”", courses_path(category: 'storytelling') %></li>
              <li><%= link_to "ë™í™”ë§Œë“¤ê¸°", courses_path(category: 'education') %></li>
              <li><%= link_to "ì²­ì†Œë…„ ì½˜í…ì¸ ", teen_content_path %></li>
              <li><%= link_to "ì „ì²´ ì½˜í…ì¸ ", courses_path %></li>
            </ul>
          </div>
          
          <div class="col-lg-2 col-md-4 mb-4">
            <h5 class="footer-title">ê³ ê°ì§€ì›</h5>
            <ul class="footer-links">
              <li><a href="#">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a></li>
              <li><a href="#">ì´ìš© ê°€ì´ë“œ</a></li>
              <li><a href="#">ë¬¸ì˜í•˜ê¸°</a></li>
              <li><a href="#">ê³µì§€ì‚¬í•­</a></li>
            </ul>
          </div>
          
          <div class="col-lg-2 col-md-4 mb-4">
            <h5 class="footer-title">íšŒì‚¬</h5>
            <ul class="footer-links">
              <li><a href="#">íšŒì‚¬ ì†Œê°œ</a></li>
              <li><a href="#">ì´ìš©ì•½ê´€</a></li>
              <li><a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
              <li><a href="#">ì‘ê°€ ëª¨ì§‘</a></li>
            </ul>
          </div>
          
          <div class="col-lg-2 mb-4">
            <h5 class="footer-title">ì—°ë½ì²˜</h5>
            <ul class="footer-contact">
              <li><i class="bi bi-envelope"></i> info@jeonghwa.com</li>
              <li><i class="bi bi-telephone"></i> 02-1234-5678</li>
              <li><i class="bi bi-clock"></i> í‰ì¼ 09:00 - 18:00</li>
            </ul>
          </div>
        </div>
        
        <hr class="footer-divider">
        
        <div class="footer-bottom">
          <p class="mb-0">Â© 2024 ì •í™”ì˜ ì„œì¬. All rights reserved.</p>
          <p class="mb-0 small text-muted">Made with â¤ï¸ for children's imagination</p>
        </div>
      </div>
    </footer>

    <!-- ìŠ¤í¬ë¡¤ íˆ¬ íƒ‘ ë²„íŠ¼ -->
    <button id="scrollTop" class="scroll-top-btn">
      <i class="bi bi-arrow-up"></i>
    </button>

    <!-- AOS ì´ˆê¸°í™” -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
      AOS.init({
        duration: 800,
        once: true,
        offset: 100
      });
    </script>

    <!-- ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤í¬ë¡¤ íš¨ê³¼
        const navbar = document.getElementById('mainNav');
        window.addEventListener('scroll', function() {
          if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
          } else {
            navbar.classList.remove('scrolled');
          }
        });
        
        // ìŠ¤í¬ë¡¤ íˆ¬ íƒ‘
        const scrollTopBtn = document.getElementById('scrollTop');
        window.addEventListener('scroll', function() {
          if (window.scrollY > 300) {
            scrollTopBtn.classList.add('show');
          } else {
            scrollTopBtn.classList.remove('show');
          }
        });
        
        scrollTopBtn.addEventListener('click', function() {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
        
        // í† ìŠ¤íŠ¸ ìë™ ìˆ¨ê¹€
        const toasts = document.querySelectorAll('.toast-modern');
        toasts.forEach(toast => {
          setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 300);
          }, 5000);
        });
      });
    </script>

    <style>
      /* ì ‘ê·¼ì„± ìŠ¤í‚µë§í¬ */
      .skip-link {
        position: absolute; left: -9999px; top: 0; padding: 8px 12px; background: #000; color: #fff; z-index: 10000; border-radius: 6px;
      }
      .skip-link:focus { left: 10px; top: 10px; outline: 3px solid #ffd60a; }

      /* ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
      .navbar-modern {
        padding: 1rem 0;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(10px);
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
      }
      
      .navbar-modern.scrolled {
        padding: 0.5rem 0;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      }
      
      .brand-wrapper {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      
      .brand-icon {
        font-size: 2rem;
        animation: float 3s ease-in-out infinite;
      }
      
      .brand-name {
        font-size: 1.5rem;
        font-weight: 800;
        margin: 0;
        line-height: 1;
      }
      
      .brand-tagline {
        font-size: 0.75rem;
        color: #718096;
        margin: 0;
      }
      
      .nav-link-modern {
        padding: 0.5rem 1rem;
        margin: 0 0.25rem;
        border-radius: 12px;
        font-weight: 500;
        color: #4a5568;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }
      
      .nav-link-modern:hover {
        background: rgba(102, 126, 234, 0.1);
        color: #667eea;
        transform: translateY(-2px);
      }
      
      .nav-link-modern.active {
        background: var(--primary-gradient);
        color: white;
      }
      
      
      .nav-icon {
        font-size: 1.2rem;
      }
      
      .cart-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #f56565;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: bold;
      }
      
      .user-avatar {
        width: 32px;
        height: 32px;
        background: var(--primary-gradient);
        color: white;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 8px;
      }
      
      .dropdown-menu-modern {
        border: none;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        padding: 0.5rem;
        margin-top: 0.5rem;
      }
      
      .dropdown-item {
        border-radius: 8px;
        padding: 0.5rem 1rem;
        transition: all 0.2s ease;
      }
      
      .dropdown-item:hover {
        background: rgba(102, 126, 234, 0.1);
        transform: translateX(4px);
      }
      
      /* ì»¤ìŠ¤í…€ í† ê¸€ëŸ¬ */
      .custom-toggler {
        border: none;
        padding: 4px 8px;
      }
      
      .toggler-icon {
        display: block;
        width: 25px;
        height: 3px;
        background: #4a5568;
        margin: 5px 0;
        transition: all 0.3s ease;
        border-radius: 2px;
      }
      
      .navbar-toggler:focus {
        box-shadow: none;
      }
      
      /* ë©”ì¸ ì½˜í…ì¸  */
      .main-content {
        min-height: calc(100vh - 80px);
        padding-top: 80px;
      }
      
      /* í‘¸í„° */
      .footer-modern {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 60px 0 30px;
        margin-top: 80px;
      }
      
      .footer-title {
        font-weight: 700;
        margin-bottom: 1rem;
      }
      
      .footer-links {
        list-style: none;
        padding: 0;
      }
      
      .footer-links li {
        margin-bottom: 0.5rem;
      }
      
      .footer-links a {
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: all 0.3s ease;
      }
      
      .footer-links a:hover {
        color: white;
        transform: translateX(4px);
        display: inline-block;
      }
      
      .footer-contact {
        list-style: none;
        padding: 0;
      }
      
      .footer-contact li {
        margin-bottom: 0.5rem;
        color: rgba(255, 255, 255, 0.9);
      }
      
      .footer-contact i {
        margin-right: 8px;
      }
      
      .social-links {
        display: flex;
        gap: 12px;
      }
      
      .social-link {
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        transition: all 0.3s ease;
      }
      
      .social-link:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-4px);
      }
      
      .footer-divider {
        border-color: rgba(255, 255, 255, 0.2);
        margin: 40px 0 20px;
      }
      
      .footer-bottom {
        text-align: center;
      }
      
      /* ìŠ¤í¬ë¡¤ íˆ¬ íƒ‘ */
      .scroll-top-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        background: var(--primary-gradient);
        color: white;
        border: none;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        z-index: 1000;
      }
      
      .scroll-top-btn.show {
        opacity: 1;
        visibility: visible;
      }
      
      .scroll-top-btn:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
      }
      
      /* í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ */
      .toast-container {
        position: fixed;
        top: 100px;
        right: 20px;
        z-index: 10000;
      }
      
      /* ë°˜ì‘í˜• */
      @media (max-width: 768px) {
        .main-content {
          padding-top: 70px;
        }
        
        .brand-name {
          font-size: 1.2rem;
        }
        
        .brand-tagline {
          display: none;
        }
        
        .nav-link-modern {
          padding: 0.75rem;
        }
      }
    </style>
  </body>
</html>